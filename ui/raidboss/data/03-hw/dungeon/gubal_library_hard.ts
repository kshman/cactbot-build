import Conditions from '../../../../../resources/conditions';
import { Responses } from '../../../../../resources/responses';
import ZoneId from '../../../../../resources/zone_id';
import { RaidbossData } from '../../../../../types/data';
import { TriggerSet } from '../../../../../types/trigger';

export interface Data extends RaidbossData {
  markers?: string[];
}

// The Great Gubal Library--Hard
const triggerSet: TriggerSet<Data> = {
  zoneId: ZoneId.TheGreatGubalLibraryHard,
  timelineFile: 'gubal_library_hard.txt',
  timelineTriggers: [
    {
      id: 'Gubal Hard Triclip',
      regex: /Triclip/,
      beforeSeconds: 5,
      response: Responses.tankBuster(),
    },
    {
      id: 'Gubal Hard Searing Wind',
      regex: /Searing Wind/,
      beforeSeconds: 5,
      response: Responses.tankCleave(),
    },
    {
      id: 'Gubal Hard Properties of Darkness',
      regex: /Darkness \(buster\)/,
      beforeSeconds: 5,
      response: Responses.tankBuster(),
    },
  ],
  triggers: [
    {
      id: 'Gubal Hard Bibliocide',
      type: 'StartsUsing',
      netRegex: { id: '1945', source: 'Liquid Flame', capture: false },
      response: Responses.aoe(),
    },
    {
      id: 'Gubal Hard Ferrofluid',
      type: 'HeadMarker',
      netRegex: { id: ['0030', '0031'] },
      condition: (data, matches) => data.me === matches.target || matches.targetId.startsWith('4'),
      preRun: (data, matches) => {
        data.markers ??= [];
        data.markers.push(matches.id);
      },
      infoText: (data, _matches, output) => {
        if (data.markers?.length === 2) {
          const sameMarkers = data.markers[0] === data.markers[1];
          delete data.markers;
          if (sameMarkers)
            return output.closeToBoss!();

          return output.awayFromBoss!();
        }
      },
      outputStrings: {
        closeToBoss: {
          en: 'ë³´ìŠ¤ì—ê²Œ ê°€ê¹Œì´',
          de: 'Nahe zum Boss',
          fr: 'Rapprochez-vous du boss',
          ja: 'ãƒœã‚¹ã«è¿‘ã¥ã',
          cn: 'é è¿‘boss',
          ko: 'ë³´ìŠ¤ì™€ ê°€ê¹Œì´ ì„œê¸°',
        },
        awayFromBoss: {
          en: 'ë³´ìŠ¤ì™€ ë©€ì–´ì ¸ìš”',
          de: 'Weg vom Boss',
          fr: 'Ã‰loignez-vous du boss',
          ja: 'ãƒœã‚¹ã‹ã‚‰é›¢ã‚Œã‚‹',
          cn: 'è¿œç¦»boss',
          ko: 'ë³´ìŠ¤ì™€ ë–¨ì–´ì§€ê¸°',
        },
      },
    },
    {
      id: 'Gubal Hard Slosh',
      type: 'Tether',
      netRegex: { id: '0039', source: 'Liquid Flame' },
      condition: Conditions.targetIsYou(),
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'ë³´ìŠ¤ì™€ ë©€ì–´ì ¸ìš”',
          de: 'Weg vom Boss',
          fr: 'Ã‰loignez-vous du boss',
          ja: 'ãƒœã‚¹ã‹ã‚‰é›¢ã‚Œã‚‹',
          cn: 'è¿œç¦»boss',
          ko: 'ë©€ì–´ì§€ê¸°',
        },
      },
    },
    {
      id: 'Gubal Hard Sunseal',
      type: 'GainsEffect',
      netRegex: { effectId: '46F' },
      condition: Conditions.targetIsYou(),
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'ë¹¨ê°•ğŸ”´ìœ¼ë¡œ',
          de: 'Im Roten stehen',
          fr: 'Placez-vous dans le rouge',
          ja: 'èµ¤è‰²ã«å…¥ã‚‹',
          cn: 'ç«™åœ¨çº¢è‰²',
          ko: 'ë¹¨ê°•ì¥íŒì— ì„œê¸°',
        },
      },
    },
    {
      id: 'Gubal Hard Moonseal',
      type: 'GainsEffect',
      netRegex: { effectId: '470' },
      condition: Conditions.targetIsYou(),
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'íŒŒë‘ğŸ”µìœ¼ë¡œ',
          de: 'Im Blauen stehen',
          fr: 'Placez-vous dans le bleu',
          ja: 'é’è‰²ã«å…¥ã‚‹',
          cn: 'ç«™åœ¨è“è‰²',
          ko: 'íŒŒë‘ì¥íŒì— ì„œê¸°',
        },
      },
    },
    {
      // This inflicts a vulnerability stack on the tank if not interrupted
      id: 'Gubal Hard Condensed Libra',
      type: 'StartsUsing',
      netRegex: { id: '198D', source: 'Mechanoscribe', capture: false },
      infoText: (data, _matches, output) => {
        if (data.CanSilence())
          return output.interruptMechanoscribe!();

        if (data.CanStun())
          return output.stunMechanoscribe!();
      },
      outputStrings: {
        interruptMechanoscribe: {
          en: 'ì¸í„°ëŸ½íŠ¸: ë©”ì¹´ë…¸ìŠ¤í¬ë¼ì´ë¸Œ',
          de: 'unterbreche Mechanoscholar',
          fr: 'Interrompez le MÃ©cano-scribe',
          ja: 'æ²ˆé»™ï¼šãƒ¡ã‚«ãƒã‚¹ã‚¯ãƒ©ã‚¤ãƒ–',
          cn: 'æ‰“æ–­äººå¶',
          ko: 'ê¸°ê³„ ì„œê¸° ì°¨ë‹¨',
        },
        stunMechanoscribe: {
          en: 'ìŠ¤í„´: ë©”ì¹´ë…¸ìŠ¤í¬ë¼ì´ë¸Œ',
          de: 'betÃ¤ube Mechanoscholar',
          fr: 'Ã‰tourdissez le MÃ©cano-scribe',
          ja: 'ã‚¹ã‚¿ãƒ³ï¼šãƒ¡ã‚«ãƒã‚¹ã‚¯ãƒ©ã‚¤ãƒ–',
          cn: 'çœ©æ™•äººå¶',
          ko: 'ê¸°ê³„ ì„œê¸° ê¸°ì ˆ',
        },
      },
    },
    {
      id: 'Gubal Hard Properties of Quakes',
      type: 'StartsUsing',
      netRegex: { id: '1956', source: 'Strix', capture: false },
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'í°âšªë™ê·¸ë¼ë¯¸ë¡œ',
          de: 'Im hellen Kreis stehen',
          fr: 'Placez-vous dans le cercle blanc',
          ja: 'ç™½ã„è¼ªã«å…¥ã‚‹',
          cn: 'å»ç™½è‰²åŒºåŸŸ',
          ko: 'ë¹› ì¥íŒìœ¼ë¡œ',
        },
      },
    },
    {
      id: 'Gubal Hard Properties of Tornadoes',
      type: 'StartsUsing',
      netRegex: { id: '1957', source: 'Strix', capture: false },
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'ê¹œì¥âš«ë™ê·¸ë¼ë¯¸ë¡œ',
          de: 'Im dunklen Kreis stehen',
          fr: 'Placez-vous dans le cercle noir',
          ja: 'é»’ã„è¼ªã«å…¥ã‚‹',
          cn: 'å»é»‘è‰²åŒºåŸŸ',
          ko: 'ì–´ë‘  ì¥íŒìœ¼ë¡œ',
        },
      },
    },
    {
      id: 'Gubal Hard Properties of Imps',
      type: 'StartsUsing',
      netRegex: { id: '1959', source: 'Strix', capture: false },
      infoText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'ì´ˆë¡ğŸŸ¢ë™ê·¸ë¼ë¯¸ë¡œ',
          de: 'Im grÃ¼nen Kreis reinigen',
          fr: 'Purifiez-vous dans le cercle vert',
          ja: 'ç·‘ã®è¼ªã«å…¥ã‚‹',
          cn: 'å»ç»¿è‰²åŒºåŸŸ',
          ko: 'ì´ˆë¡ ì¥íŒìœ¼ë¡œ',
        },
      },
    },
    {
      id: 'Gubal Hard Properties of Thunder',
      type: 'StartsUsing',
      netRegex: { id: '195A', source: 'Strix', capture: false },
      response: Responses.spread(),
    },
    {
      id: 'Gubal Hard Properties of Darkness II',
      type: 'StartsUsing',
      netRegex: { id: '1955', source: 'Strix', capture: false },
      response: Responses.aoe(),
    },
    {
      id: 'Gubal Hard Ecliptic Meteor',
      type: 'StartsUsing',
      netRegex: { id: '195D', source: 'Behemoth Ward', capture: false },
      delaySeconds: 14, // Leaving about 10s warning to complete the LoS
      alertText: (_data, _matches, output) => output.text!(),
      outputStrings: {
        text: {
          en: 'ë©”í…Œì˜¤ ë’¤ì— ìˆ¨ì–´ìš”',
          de: 'Hinter dem Brocken verstecken',
          fr: 'Cachez-vous derriÃ¨re le rocher',
          ja: 'ãƒ¡ãƒ†ã‚ªã®å¾Œã‚ã«',
          cn: 'ç«™åœ¨é™¨çŸ³å',
          ko: 'ìš´ì„ ë’¤ì— ìˆ¨ê¸°',
        },
      },
    },
  ],
  timelineReplace: [
    {
      'locale': 'de',
      'replaceSync': {
        'Behemoth Ward': 'Buch-Behemoth',
        'Demon of the Tome': 'BÃ¼cherdÃ¤mon',
        'Liquid Flame': 'flÃ¼ssig(?:e|er|es|en) Flamme',
        'Mechanoscribe': 'Mechanoscholar',
        'Meteor': 'Meteor',
        'Middle Shelf Tome': 'Pappband',
        'Strix': 'Strix',
        'The Astrology and Astromancy Camera': 'Astrologische und Astronomische GewÃ¶lbe',
        'The Hall of Magicks': 'Halle der Magie',
        'The Rare Tomes Room': 'Abteilung fÃ¼r seltene Schriften',
        'Top Shelf Tome': 'Prachtband',
      },
      'replaceText': {
        '\\(buster\\)': '(Tankbuster)',
        'Bibliocide': 'Bibliozid',
        'Book Drop': 'Buch fÃ¤llt',
        'Check Out': 'Anthologie',
        'Discontinue': 'Druck einstellen',
        'Ecliptic Meteor': 'Ekliptik-Meteor',
        'Folio': 'Foliant',
        'Form Shift': 'Formwechsel',
        'Frightful Roar': 'Furchtbares BrÃ¼llen',
        'Hand/Tornado': 'Hand/Tornado',
        'Issue': 'Publizieren',
        'Magnetism': 'Magnetismus',
        'Meteor Impact': 'Meteoreinschlag',
        'Properties Of Darkness': 'Theorie der Dunkelung',
        'Properties Of Imps': 'Ãœber Flusskobolde',
        'Properties Of Quakes': 'Theorie des Seisga',
        'Properties Of Thunder III': 'Theorie des Blitzga',
        'Properties Of Tornados': 'Theorie des Tornado',
        'Quakes/Tornados': 'Seisga/Tornados',
        'Repel': 'AbstoÃŸung',
        'Sea Of Flames': 'Flammenmeer',
        'Seal Of Night And Day': 'Siegel',
        'Searing Wind': 'Versengen',
        'Slosh': 'DurchblÃ¤uen',
        'Triclip': 'Dreischnitt',
      },
    },
    {
      'locale': 'fr',
      'replaceSync': {
        'Behemoth Ward': 'BÃ©hÃ©moth conjurÃ©',
        'Demon of the Tome': 'DÃ©mon du Tome',
        'Liquid Flame': 'Flamme liquide',
        'Mechanoscribe': 'MÃ©cano-scribe',
        'Meteor': 'MÃ©tÃ©ore',
        'Middle Shelf Tome': 'Livre brochÃ©',
        'Strix': 'Strix',
        'The Astrology and Astromancy Camera': 'dÃ´me d\'astrologie et d\'astromancie',
        'The Hall of Magicks': 'puits des magies',
        'The Rare Tomes Room': 'dÃ´me des manuscrits rares',
        'Top Shelf Tome': 'Livre reliÃ©',
      },
      'replaceText': {
        '\\?': ' ?',
        'Bibliocide': 'Bibliocide',
        'Book Drop': 'LachÃ© de livre',
        'Check Out': 'Anthologie',
        'Discontinue': 'ArrÃªt de publication',
        'Ecliptic Meteor': 'MÃ©tÃ©ore Ã©cliptique',
        'Folio': 'RÃ©impression',
        'Form Shift': 'Glissement de posture',
        'Frightful Roar': 'Rugissement effroyable',
        'Hand/Tornado': 'Main/Tornade',
        'Issue': 'Publication',
        'Magnetism/Repel': 'Attraction/RÃ©pulsion',
        'Meteor Impact': 'Impact de mÃ©tÃ©ore',
        'Properties Of Darkness II': 'PropriÃ©tÃ©s d\'Extra ObscuritÃ©',
        'Properties Of Darkness(?! II)': 'PropriÃ©tÃ©s d\'ObscuritÃ©',
        'Properties Of Imps': 'PropriÃ©tÃ©s de Coup du kappa',
        'Properties Of Quakes': 'PropriÃ©tÃ©s de MÃ©ga SÃ©isme',
        'Properties Of Thunder III': 'PropriÃ©tÃ©s de MÃ©ga Foudre',
        'Properties Of Tornados': 'PropriÃ©tÃ©s de Tornade',
        'Quakes/Tornados': 'SÃ©ismes/Tornades',
        'Sea Of Flames': 'Mer de flammes',
        'Seal Of Night And Day': 'Gravure',
        'Searing Wind': 'Carbonisation',
        'Slosh': 'RuÃ©e',
        'Triclip': 'Triclip',
      },
    },
    {
      'locale': 'ja',
      'replaceSync': {
        'Behemoth Ward': 'ãƒ™ãƒ’ãƒ¼ãƒ¢ã‚¹ãƒ»ãƒ¯ãƒ¼ãƒ‰',
        'Demon of the Tome': 'ãƒ‡ãƒ¢ãƒ³ãƒ»ã‚ªãƒ–ãƒ»ãƒˆãƒ¼ãƒ ',
        'Liquid Flame': 'ãƒªã‚¯ã‚¤ãƒ‰ãƒ•ãƒ¬ã‚¤ãƒ ',
        'Mechanoscribe': 'ãƒ¡ã‚«ãƒã‚¹ã‚¯ãƒ©ã‚¤ãƒ–',
        'Meteor': 'ãƒ¡ãƒ†ã‚ª',
        'Middle Shelf Tome': 'ä¸¦è£½æœ¬',
        'Strix': 'ã‚¹ãƒˆãƒªãƒƒã‚¯ã‚¹',
        'The Astrology and Astromancy Camera': 'å æ˜Ÿå­¦ç ”ç©¶å®¤',
        'The Hall of Magicks': 'é­”æ›¸ã®ç¿¼å»Š',
        'The Rare Tomes Room': 'æ€æƒ³ç¨€è¦¯æ›¸åº«',
        'Top Shelf Tome': 'ä¸Šè£½æœ¬',
      },
      'replaceText': {
        '\\(buster\\)': '(ãƒã‚¹ã‚¿ãƒ¼)',
        'Bibliocide': 'ç«ç‚',
        'Book Drop': 'æœ¬è½ä¸‹',
        'Check Out': 'é¸æ›¸',
        'Discontinue': 'å»ƒåˆŠ',
        'Ecliptic Meteor': 'ã‚¨ã‚¯ãƒªãƒ—ã‚¹ãƒ¡ãƒ†ã‚ª',
        'Folio': 'é‡ç‰ˆ',
        'Form Shift': 'æ¼”æ­¦',
        'Frightful Roar': 'ãƒ•ãƒ©ã‚¤ãƒˆãƒ•ãƒ«ãƒ­ã‚¢',
        'Hand/Tornado': 'æ‰‹/ç«œå·',
        'Issue': 'åˆŠè¡Œ',
        'Magnetism': 'ç£åŠ›',
        'Meteor Impact': 'ãƒ¡ãƒ†ã‚ªã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ',
        'Properties Of Darkness II': 'ãƒ€ãƒ¼ã‚¯ãƒ©ã®ç« ',
        'Properties Of Darkness(?! II)': 'ãƒ€ãƒ¼ã‚¯ã®ç« ',
        'Properties Of Imps': 'ã‚«ãƒƒãƒ‘ã®ç« ',
        'Properties Of Quakes': 'ã‚¯ã‚¨ã‚¤ã‚¬ã®ç« ',
        'Properties Of Thunder III': 'ã‚µãƒ³ãƒ€ã‚¬ã®ç« ',
        'Properties Of Tornados': 'ãƒˆãƒ«ãƒãƒ‰ã®ç« ',
        'Quakes/Tornados': 'ã‚¯ã‚¨ã‚¤ã‚¬ã®ç« /ãƒˆãƒ«ãƒãƒ‰ã®ç« ',
        'Repel': 'åç™º',
        'Sea Of Flames': 'ã‚·ãƒ¼ãƒ»ã‚ªãƒ–ãƒ»ãƒ•ãƒ¬ã‚¤ãƒ ',
        'Seal Of Night And Day': 'åˆ»å°',
        'Searing Wind': 'ç†±é¢¨',
        'Slosh': 'çªé€²',
        'Triclip': 'ãƒˆãƒ©ã‚¤ã‚¯ãƒªãƒƒãƒ—',
      },
    },
    {
      'locale': 'cn',
      'replaceSync': {
        'Behemoth Ward': 'è´å¸Œæ‘©æ–¯æŠ¤å«',
        'Demon of the Tome': 'ä¹¦ä¸­æ¶é­”',
        'Liquid Flame': 'æ¶²æ€ç«ç„°',
        'Mechanoscribe': 'è‡ªèµ°äººå¶æŠ„å†™å‘˜',
        'Meteor': 'é™¨çŸ³',
        'Middle Shelf Tome': 'å¹³è£…æœ¬',
        'Strix': 'åšå­¦æ—é¸®',
        'The Astrology and Astromancy Camera': 'å æ˜Ÿå­¦ç ”ç©¶å®¤',
        'The Hall of Magicks': 'é­”ä¹¦ç¿¼å»Š',
        'The Rare Tomes Room': 'æ€æƒ³çç§˜ä¹¦åº“',
        'Top Shelf Tome': 'ç²¾è£…æœ¬',
      },
      'replaceText': {
        '\\?': ' ?',
        'Bibliocide': 'ç„šä¹¦',
        'Book Drop': 'ä¹¦è½ä¸‹',
        'Check Out': 'é€‰é›†',
        'Discontinue': 'åœåˆŠ',
        'Ecliptic Meteor': 'é»„é“é™¨çŸ³',
        'Folio': 'å†ç‰ˆ',
        'Form Shift': 'æ¼”æ­¦',
        'Frightful Roar': 'éª‡äººåšå«',
        'Hand/Tornado': 'æ‰‹/é¾™å·',
        'Issue': 'å‘è¡Œ',
        'Magnetism/Repel': 'ç£åŠ›/ç›¸æ–¥',
        'Meteor Impact': 'é™¨çŸ³å†²å‡»',
        'Properties Of Darkness II': 'æ˜æš—ä¹‹ç« ',
        'Properties Of Darkness(?! II)': 'é»‘æš—ä¹‹ç« ',
        'Properties Of Imps': 'æ²³ç«¥ä¹‹ç« ',
        'Properties Of Quakes': 'çˆ†éœ‡ä¹‹ç« ',
        'Properties Of Thunder III': 'æš´é›·ä¹‹ç« ',
        'Properties Of Tornados': 'é¾™å·ä¹‹ç« ',
        'Quakes/Tornados': 'çˆ†éœ‡/é¾™å·',
        'Sea Of Flames': 'ç«æµ·',
        'Seal Of Night And Day': 'åˆ»å°',
        'Searing Wind': 'çƒ­é£',
        'Slosh': 'çªè¿›',
        'Triclip': 'ä¸‰è¿çˆª',
      },
    },
    {
      'locale': 'ko',
      'replaceSync': {
        'Behemoth Ward': 'ê³ ì„œì˜ ë² íˆëª¨ìŠ¤',
        'Demon of the Tome': 'ê³ ì„œì˜ ì•…ë§ˆ',
        'Liquid Flame': 'ì•¡ì²´ ë¶ˆê½ƒ',
        'Mechanoscribe': 'ê¸°ê³„ ì„œê¸°',
        'Meteor': 'ë©”í…Œì˜¤',
        'Middle Shelf Tome': 'ë¬¸ê³ ë³¸',
        'Strix': 'ìŠ¤íŠ¸ë¦­ìŠ¤',
        'The Astrology and Astromancy Camera': 'ì ì„±í•™ ì—°êµ¬ì‹¤',
        'The Hall of Magicks': 'ì•…ë§ˆì„œ ë³µë„',
        'The Rare Tomes Room': 'ì‚¬ìƒí¬ê·€ì„œê³ ',
        'Top Shelf Tome': 'ì–‘ì¥ë³¸',
      },
      'replaceText': {
        'Bibliocide': 'í™”ì—¼',
        'Book Drop': 'ì±… ë–¨ì–´ì§',
        'Check Out': 'ë„ì„œ ì„ ì •',
        'Discontinue': 'íê°„',
        'Ecliptic Meteor': 'í™©ë„ ë©”í…Œì˜¤',
        'Folio': 'ì¦ì‡„',
        'Form Shift': 'ì—°ë¬´',
        'Frightful Roar': 'ë”ì°í•œ í¬íš¨',
        'Hand/Tornado': 'ì†/í† ë„¤ì´ë„',
        'Issue': 'ê°„í–‰',
        'Magnetism': 'ìë ¥',
        'Meteor Impact': 'ìš´ì„ ë‚™í•˜',
        'Properties Of Darkness': 'ë‹¤í¬ì˜ ì¥',
        'Properties Of Imps': 'ë¬¼ìš”ì •ì˜ ì¥',
        'Properties Of Quakes': 'í€˜ì´ê°€ì˜ ì¥',
        'Properties Of Thunder III': 'ì„ ë”ê°€ì˜ ì¥',
        'Properties Of Tornados': 'í† ë„¤ì´ë„ì˜ ì¥',
        'Repel': 'ë°˜ë°œ',
        'Sea Of Flames': 'í™”ì—¼ì˜ ë°”ë‹¤',
        'Seal Of Night And Day': 'ê°ì¸',
        'Searing Wind': 'ì—´í’',
        'Slosh': 'ëŒì§„',
        'Triclip': 'ì‚¼ë‹¨ë² ê¸°',
        'Quakes/Tornados': 'í€˜ì´ê°€/í† ë„¤ì´ë„',
      },
    },
  ],
};

export default triggerSet;
